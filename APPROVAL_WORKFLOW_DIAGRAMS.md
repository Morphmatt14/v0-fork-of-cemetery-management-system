# ğŸ“Š Admin Approval Workflow - Visual Diagrams

## System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EMPLOYEE PORTAL                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ Lots Tab     â”‚  â”‚ Payments Tab â”‚  â”‚ Clients Tab  â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚         â”‚                 â”‚                  â”‚                           â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                           â”‚                                              â”‚
â”‚                    [Employee Action]                                     â”‚
â”‚                           â†“                                              â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚                  â”‚ Check Config   â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                     â”‚
â”‚                           â”‚                      â”‚                     â”‚
â”‚                  Requires Approval?              â”‚                     â”‚
â”‚                    â†™            â†˜                â”‚                     â”‚
â”‚                 YES              NO               â”‚                     â”‚
â”‚                  â†“                â†“               â”‚                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  [Execute Now]         â”‚                     â”‚
â”‚         â”‚ Submit for    â”‚  [Log & Notify]        â”‚                     â”‚
â”‚         â”‚ Approval      â”‚                         â”‚                     â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚                     â”‚
â”‚                 â”‚                                  â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                                  â”‚
                  â†“                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         API LAYER                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  POST /api/approvals                                                     â”‚
â”‚       â†“                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚  1. Validate action                      â”‚                           â”‚
â”‚  â”‚  2. Store in pending_actions table      â”‚                           â”‚
â”‚  â”‚  3. Create notification for admins      â”‚                           â”‚
â”‚  â”‚  4. Log activity                         â”‚                           â”‚
â”‚  â”‚  5. Return pending status                â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚       â†“                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATABASE                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  pending_actions Table                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ id, action_type, target_entity, target_id               â”‚           â”‚
â”‚  â”‚ change_data (JSONB), previous_data (JSONB)             â”‚           â”‚
â”‚  â”‚ status: 'pending', requested_by_id, created_at          â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                           â†“                                              â”‚
â”‚  Notification Created                                                    â”‚
â”‚                           â†“                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ADMIN PORTAL                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚           APPROVALS TAB (New)                     â”‚                 â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚  â”‚                                                    â”‚                 â”‚
â”‚  â”‚  ğŸ“Š Stats: 12 Pending | 8 Approved | 2 Rejected  â”‚                 â”‚
â”‚  â”‚                                                    â”‚                 â”‚
â”‚  â”‚  ğŸ“‹ Pending Actions List:                         â”‚                 â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                 â”‚
â”‚  â”‚  â”‚ âš¡ John Doe - Lot Update (A-123)            â”‚â”‚                 â”‚
â”‚  â”‚  â”‚    Status: Available â†’ Sold                 â”‚â”‚                 â”‚
â”‚  â”‚  â”‚    Price: â‚±50,000 â†’ â‚±75,000                 â”‚â”‚                 â”‚
â”‚  â”‚  â”‚    [View Details] [Approve] [Reject]        â”‚â”‚                 â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚                 â”‚
â”‚  â”‚                                                    â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚
â”‚                           â†“                                              â”‚
â”‚                   [Admin Reviews]                                        â”‚
â”‚                           â†“                                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚              â”‚   Review Dialog         â”‚                                â”‚
â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
â”‚              â”‚ Before    â”‚   After     â”‚                                â”‚
â”‚              â”‚ Status:   â”‚   Status:   â”‚                                â”‚
â”‚              â”‚ Available â”‚   Sold      â”‚                                â”‚
â”‚              â”‚           â”‚             â”‚                                â”‚
â”‚              â”‚ [Approve] â”‚ [Reject]   â”‚                                â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                           â†“                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXECUTION ENGINE                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  If APPROVED:                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚  1. Extract change_data                  â”‚                          â”‚
â”‚  â”‚  2. Execute actual database update       â”‚                          â”‚
â”‚  â”‚  3. Mark pending_action as executed      â”‚                          â”‚
â”‚  â”‚  4. Create notification for employee     â”‚                          â”‚
â”‚  â”‚  5. Log successful execution             â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                                           â”‚
â”‚  If REJECTED:                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚  1. Update status to 'rejected'          â”‚                          â”‚
â”‚  â”‚  2. Store rejection reason                â”‚                          â”‚
â”‚  â”‚  3. Notify employee with reason           â”‚                          â”‚
â”‚  â”‚  4. Log rejection                         â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Diagram

```
EMPLOYEE SUBMITS ACTION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Employee UI â”‚
â”‚  (Lots Tab) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. User clicks "Update Lot"
       â”‚ 2. Opens dialog, makes changes
       â”‚ 3. Clicks "Save"
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ handleUpdateLot()    â”‚
â”‚ (Frontend Function)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Check: requiresApproval('lot_update')
       â”‚        â””â”€â†’ Fetch from approval_workflow_config
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ submitPendingAction()    â”‚
â”‚ POST /api/approvals      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Request Body:
       â”‚ {
       â”‚   action_type: "lot_update",
       â”‚   target_entity: "lot",
       â”‚   target_id: "uuid-123",
       â”‚   change_data: {
       â”‚     status: "Sold",
       â”‚     price: 75000
       â”‚   },
       â”‚   previous_data: {
       â”‚     status: "Available",
       â”‚     price: 50000
       â”‚   }
       â”‚ }
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ API: /api/approvals/route.tsâ”‚
â”‚ POST Handler                 â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Validate request
       â”‚ 2. Get employee info from session
       â”‚ 3. Insert into pending_actions table
       â”‚ 4. Create notification for admins
       â”‚ 5. Log activity
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Database: pending_actions    â”‚
â”‚ INSERT                       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Record stored:
       â”‚ {
       â”‚   id: "action-uuid",
       â”‚   status: "pending",
       â”‚   requested_by_id: "emp-uuid",
       â”‚   created_at: "2024-11-20T10:30:00Z"
       â”‚   ...
       â”‚ }
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Notification Created         â”‚
â”‚ notifications table          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ {
       â”‚   recipient_type: "admin",
       â”‚   notification_type: "approval_request",
       â”‚   message: "John Doe submitted lot_update",
       â”‚   priority: "normal"
       â”‚ }
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response to Employee         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ { 
       â”‚   success: true,
       â”‚   id: "action-uuid",
       â”‚   status: "pending",
       â”‚   message: "Submitted for approval"
       â”‚ }
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Employee sees Toast:         â”‚
â”‚ "Submitted for Approval"     â”‚
â”‚ "Your changes will be        â”‚
â”‚  reviewed by an admin"       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ADMIN REVIEWS AND APPROVES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin UI   â”‚
â”‚(Approvals)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Admin opens Approvals tab
       â”‚ 2. Sees notification badge
       â”‚ 3. Views pending action
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/approvals       â”‚
â”‚ ?status=pending          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Returns list of pending actions
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Admin clicks "View Details"  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Shows Review Dialog with:
       â”‚ - Before/After comparison
       â”‚ - Employee who requested
       â”‚ - Timestamp
       â”‚ - Notes
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Admin clicks "Approve"       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ POST /api/approvals/:id/review
       â”‚ {
       â”‚   action: "approve",
       â”‚   admin_notes: "Verified with client"
       â”‚ }
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ API: reviewPendingAction()       â”‚
â”‚ /api/approvals/[id]/review       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Verify admin permissions
       â”‚ 2. Update pending_actions:
       â”‚    - status = 'approved'
       â”‚    - reviewed_by_id = admin.id
       â”‚    - reviewed_at = NOW()
       â”‚ 3. Execute the action
       â”‚ 4. Notify employee
       â”‚ 5. Log approval
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EXECUTE ACTION                   â”‚
â”‚ executePendingAction()           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Read change_data from pending_action
       â”‚ 2. Call actual API:
       â”‚    PUT /api/lots/:id
       â”‚    { status: "Sold", price: 75000 }
       â”‚ 3. Mark pending_action.is_executed = true
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Database: lots table             â”‚
â”‚ UPDATE                           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ UPDATE lots 
       â”‚ SET status = 'Sold',
       â”‚     price = 75000,
       â”‚     updated_at = NOW()
       â”‚ WHERE id = 'uuid-123'
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Notification to Employee         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ {
       â”‚   recipient_type: "employee",
       â”‚   recipient_id: "emp-uuid",
       â”‚   notification_type: "approval_approved",
       â”‚   message: "Your lot update was approved"
       â”‚ }
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Activity Log                     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3 Log entries created:
       â”‚ 1. approval_granted (by admin)
       â”‚ 2. lot_update (via approval)
       â”‚ 3. approval_executed (system)
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Employee receives notification   â”‚
â”‚ "Your lot update for A-123       â”‚
â”‚  has been approved and executed" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Database Entity Relationship

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                EXISTING TABLES (Unmodified)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   ADMINS    â”‚        â”‚  EMPLOYEES  â”‚
    â”‚             â”‚        â”‚             â”‚
    â”‚ â€¢ id (PK)   â”‚        â”‚ â€¢ id (PK)   â”‚
    â”‚ â€¢ username  â”‚        â”‚ â€¢ username  â”‚
    â”‚ â€¢ name      â”‚        â”‚ â€¢ name      â”‚
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚                      â”‚
           â”‚                      â”‚
           â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚     â”‚
           â”‚     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          â”‚     â”‚     NEW TABLES (Added)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚     â”‚
           â”‚     â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    PENDING_ACTIONS (New)                â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ â€¢ id (PK)                                â”‚
    â”‚ â€¢ action_type                            â”‚
    â”‚ â€¢ target_entity                          â”‚
    â”‚ â€¢ target_id                              â”‚
    â”‚ â€¢ change_data (JSONB)     â—„â”€â”€â”€â”€â”        â”‚
    â”‚ â€¢ previous_data (JSONB)         â”‚        â”‚
    â”‚ â€¢ status                        â”‚        â”‚
    â”‚ â€¢ requested_by_id (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
    â”‚ â€¢ reviewed_by_id (FK) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
    â”‚ â€¢ created_at                    â”‚        â”‚
    â”‚ â€¢ reviewed_at                   â”‚        â”‚
    â”‚ â€¢ is_executed                   â”‚        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
              â”‚                       â”‚        â”‚
              â”‚                       â”‚        â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”   â”‚
    â”‚  APPROVAL_WORKFLOW_CONFIG (New)      â”‚   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
    â”‚ â€¢ id (PK)                             â”‚   â”‚
    â”‚ â€¢ action_type (UNIQUE)                â”‚   â”‚
    â”‚ â€¢ requires_approval (BOOLEAN)         â”‚   â”‚
    â”‚ â€¢ expiration_days (INTEGER)           â”‚   â”‚
    â”‚ â€¢ min_approvers (INTEGER)             â”‚   â”‚
    â”‚ â€¢ notify_on_submit (BOOLEAN)          â”‚   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚        EXAMPLE DATA IN JSONB
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                 â”‚
    change_data: {                               â”‚
      "status": "Sold",                          â”‚
      "price": 75000,                            â”‚
      "owner_id": "client-uuid-456"              â”‚
    }                                            â”‚
                                                 â”‚
    previous_data: {                             â”‚
      "status": "Available",                     â”‚
      "price": 50000,                            â”‚
      "owner_id": null                           â”‚
    }                                            â”‚
                                                 â”‚
    execution_result: {                          â”‚
      "success": true,                           â”‚
      "updated_at": "2024-11-20T11:00:00Z",     â”‚
      "records_affected": 1                      â”‚
    }                                            â”‚
                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## State Transition Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PENDING ACTION STATE MACHINE                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                      [Created by Employee]
                               â”‚
                               â†“
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   PENDING    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
                               â”‚                 â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                 â”‚             â”‚             â”‚   â”‚
         [Admin Reviews]  [Auto-Expire]  [Employee]
                 â”‚             â”‚         [Cancels]
                 â†“             â†“             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
         â”‚  APPROVED  â”‚  â”‚ EXPIRED  â”‚      â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
                â”‚                           â”‚
                â”‚ [Execute]                 â”‚
                â†“                           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
         â”‚  EXECUTED  â”‚                    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
                                           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
         â”‚  REJECTED  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    
                â”‚                          
                â”‚ [With Reason]            
                â†“                          
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    
         â”‚ CANCELLED  â”‚                    
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    

State Rules:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PENDING â†’ APPROVED   (Admin approves)
PENDING â†’ REJECTED   (Admin rejects)
PENDING â†’ CANCELLED  (Employee cancels)
PENDING â†’ EXPIRED    (Auto after 7 days)
APPROVED â†’ EXECUTED  (System executes change)
REJECTED â†’ [Final]   (Cannot change)
CANCELLED â†’ [Final]  (Cannot change)
EXPIRED â†’ [Final]    (Cannot change)

Transitions Allowed:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ… PENDING â†’ APPROVED, REJECTED, CANCELLED, EXPIRED
âœ… APPROVED â†’ EXECUTED
âŒ REJECTED â†’ (No transitions)
âŒ CANCELLED â†’ (No transitions)
âŒ EXPIRED â†’ (No transitions)
âŒ EXECUTED â†’ (No transitions)
```

---

## Component Hierarchy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EMPLOYEE PORTAL                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

app/admin/employee/dashboard/page.tsx
â”‚
â”œâ”€â”€ <EmployeeDashboard />
â”‚   â”‚
â”‚   â”œâ”€â”€ <Header />
â”‚   â”‚
â”‚   â”œâ”€â”€ <Tabs />
â”‚   â”‚   â”œâ”€â”€ Overview Tab
â”‚   â”‚   â”œâ”€â”€ Lots Tab
â”‚   â”‚   â”‚   â””â”€â”€ [Modified] Wrapped with approval interceptor
â”‚   â”‚   â”œâ”€â”€ Clients Tab
â”‚   â”‚   â”‚   â””â”€â”€ [Modified] Wrapped with approval interceptor
â”‚   â”‚   â”œâ”€â”€ Payments Tab
â”‚   â”‚   â”‚   â””â”€â”€ [Modified] Wrapped with approval interceptor
â”‚   â”‚   â””â”€â”€ [NEW] My Pending Actions Tab â—„â”€â”€ NEW COMPONENT
â”‚   â”‚       â”‚
â”‚   â”‚       â”œâ”€â”€ <PendingActionsWidget /> â—„â”€â”€ NEW
â”‚   â”‚       â”‚   â”œâ”€â”€ <PendingActionCard /> â—„â”€â”€ NEW
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ <ApprovalStatusBadge /> â—„â”€â”€ NEW
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ <ActionDiffViewer /> â—„â”€â”€ NEW
â”‚   â”‚       â”‚   â””â”€â”€ <CancelActionDialog /> â—„â”€â”€ NEW
â”‚   â”‚       â”‚
â”‚   â”‚       â””â”€â”€ <ApprovalStats /> (Employee view)
â”‚   â”‚
â”‚   â””â”€â”€ <NotificationBell /> [Modified to include approval notifications]


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ADMIN PORTAL                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

app/admin/dashboard/page.tsx
â”‚
â”œâ”€â”€ <AdminDashboard />
â”‚   â”‚
â”‚   â”œâ”€â”€ <Header />
â”‚   â”‚
â”‚   â”œâ”€â”€ <Tabs />
â”‚   â”‚   â”œâ”€â”€ Overview Tab
â”‚   â”‚   â”œâ”€â”€ Lots Tab
â”‚   â”‚   â”œâ”€â”€ Employees Tab
â”‚   â”‚   â”œâ”€â”€ [NEW] Approvals Tab â—„â”€â”€ NEW MAJOR FEATURE
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ <ApprovalsTab /> â—„â”€â”€ NEW COMPONENT
â”‚   â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ <ApprovalStats /> â—„â”€â”€ NEW
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Stats: Pending count
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Stats: Approved today
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Stats: Rejected today
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Stats: Avg response time
â”‚   â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ <ApprovalFilters /> â—„â”€â”€ NEW
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Filter by: Action Type
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Filter by: Employee
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Filter by: Priority
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Sort by: Date, Priority
â”‚   â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ <PendingActionsList /> â—„â”€â”€ NEW
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ <PendingActionCard /> â—„â”€â”€ NEW
â”‚   â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ Employee info
â”‚   â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ Action type badge
â”‚   â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ Quick preview
â”‚   â”‚   â”‚   â”‚   â”‚       â””â”€â”€ [View Details] button
â”‚   â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ <ActionReviewDialog /> â—„â”€â”€ NEW
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ <ActionSummary />
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ <DiffViewer /> â—„â”€â”€ NEW
â”‚   â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ Before column
â”‚   â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ After column
â”‚   â”‚   â”‚   â”‚       â”‚   â””â”€â”€ Highlighted changes
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ <EmployeeInfo />
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ <ActionHistory />
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ <ReviewActions />
â”‚   â”‚   â”‚   â”‚           â”œâ”€â”€ [Approve] button
â”‚   â”‚   â”‚   â”‚           â”œâ”€â”€ [Reject] button
â”‚   â”‚   â”‚   â”‚           â””â”€â”€ Rejection reason textarea
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ Settings Tab
â”‚   â”‚       â””â”€â”€ [NEW] Approval Configuration â—„â”€â”€ NEW SECTION
â”‚   â”‚           â””â”€â”€ <ApprovalConfigTable /> â—„â”€â”€ NEW
â”‚   â”‚               â”œâ”€â”€ Enable/Disable per action
â”‚   â”‚               â”œâ”€â”€ Set expiration days
â”‚   â”‚               â””â”€â”€ Configure notifications
â”‚   â”‚
â”‚   â””â”€â”€ <NotificationBell /> [Modified to include approval requests]


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SHARED COMPONENTS                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

components/
â”‚
â”œâ”€â”€ employee/
â”‚   â”œâ”€â”€ PendingActionsWidget.tsx â—„â”€â”€ NEW
â”‚   â”œâ”€â”€ ApprovalStatusBadge.tsx â—„â”€â”€ NEW
â”‚   â””â”€â”€ ActionDiffViewer.tsx â—„â”€â”€ NEW
â”‚
â”œâ”€â”€ admin/
â”‚   â”œâ”€â”€ ApprovalsTab.tsx â—„â”€â”€ NEW
â”‚   â”œâ”€â”€ ApprovalStats.tsx â—„â”€â”€ NEW
â”‚   â”œâ”€â”€ PendingActionCard.tsx â—„â”€â”€ NEW
â”‚   â”œâ”€â”€ ActionReviewDialog.tsx â—„â”€â”€ NEW
â”‚   â”œâ”€â”€ DiffViewer.tsx â—„â”€â”€ NEW
â”‚   â””â”€â”€ ApprovalConfigTable.tsx â—„â”€â”€ NEW
â”‚
â””â”€â”€ shared/
    â””â”€â”€ ApprovalStatusBadge.tsx (used by both)
```

---

## API Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        API ROUTES                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

app/api/
â”‚
â”œâ”€â”€ approvals/
â”‚   â”‚
â”‚   â”œâ”€â”€ route.ts â—„â”€â”€ NEW
â”‚   â”‚   â”œâ”€â”€ GET  - List pending actions (paginated, filtered)
â”‚   â”‚   â””â”€â”€ POST - Submit new action for approval
â”‚   â”‚
â”‚   â”œâ”€â”€ [id]/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ route.ts â—„â”€â”€ NEW
â”‚   â”‚   â”‚   â”œâ”€â”€ GET    - Get single pending action details
â”‚   â”‚   â”‚   â”œâ”€â”€ PATCH  - Update pending action (cancel)
â”‚   â”‚   â”‚   â””â”€â”€ DELETE - Cancel pending action
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ review/
â”‚   â”‚       â””â”€â”€ route.ts â—„â”€â”€ NEW
â”‚   â”‚           â””â”€â”€ POST - Approve or reject action
â”‚   â”‚               â”œâ”€â”€ Approve â†’ Execute â†’ Notify
â”‚   â”‚               â””â”€â”€ Reject â†’ Update â†’ Notify
â”‚   â”‚
â”‚   â”œâ”€â”€ stats/
â”‚   â”‚   â””â”€â”€ route.ts â—„â”€â”€ NEW
â”‚   â”‚       â””â”€â”€ GET - Get approval statistics
â”‚   â”‚           â”œâ”€â”€ Pending count
â”‚   â”‚           â”œâ”€â”€ Approval rate
â”‚   â”‚           â”œâ”€â”€ By action type
â”‚   â”‚           â””â”€â”€ By employee
â”‚   â”‚
â”‚   â””â”€â”€ config/
â”‚       â””â”€â”€ route.ts â—„â”€â”€ NEW
â”‚           â”œâ”€â”€ GET  - Get workflow configuration
â”‚           â””â”€â”€ PUT  - Update workflow configuration (Admin only)
â”‚
â”œâ”€â”€ lots/ [Modified]
â”‚   â””â”€â”€ Wrapped with approval check
â”‚
â”œâ”€â”€ payments/ [Modified]
â”‚   â””â”€â”€ Wrapped with approval check
â”‚
â””â”€â”€ clients/ [Modified]
    â””â”€â”€ Wrapped with approval check


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CLIENT-SIDE API FUNCTIONS                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

lib/api/
â”‚
â”œâ”€â”€ approvals-api.ts â—„â”€â”€ NEW
â”‚   â”œâ”€â”€ submitPendingAction(data)
â”‚   â”œâ”€â”€ listPendingActions(filters)
â”‚   â”œâ”€â”€ getPendingAction(id)
â”‚   â”œâ”€â”€ reviewPendingAction(id, action, reason?)
â”‚   â”œâ”€â”€ cancelPendingAction(id)
â”‚   â”œâ”€â”€ getApprovalStats()
â”‚   â””â”€â”€ getApprovalConfig()
â”‚
â”œâ”€â”€ lots-api.ts [Modified]
â”‚   â””â”€â”€ Intercept with approval check before execution
â”‚
â”œâ”€â”€ payments-api.ts [Modified]
â”‚   â””â”€â”€ Intercept with approval check before execution
â”‚
â””â”€â”€ clients-api.ts [Modified]
    â””â”€â”€ Intercept with approval check before execution
```

---

**Document Version**: 1.0  
**Created**: November 20, 2024  
**Purpose**: Visual reference for Admin Approval Workflow implementation
